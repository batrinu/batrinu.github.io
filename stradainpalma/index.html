<!DOCTYPE html>
<html>

<head>
	<title>AR.js A-Frame</title>
	<script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
	<!-- Assumes AR.js build is in the 'AR.js' directory -->
	<script type='text/javascript' src='./ar-threex-location-only.js'></script>
	<script type='text/javascript' src='./aframe-ar.js'></script>
	<script>
		function createEntity(latitude, longitude, color) {
			const entity = document.createElement("a-entity");
			entity.setAttribute("material", `color: ${color}`);
			entity.setAttribute("geometry", "primitive: box");
			entity.setAttribute("gps-new-entity-place", `latitude: ${latitude}; longitude: ${longitude};`);
			entity.setAttribute("scale", "10 10 10");
			document.querySelector("a-scene").appendChild(entity);
		}

		function createEntities(latitude, longitude) {
			createEntity(latitude + 0.001, longitude, "red");
			createEntity(latitude - 0.001, longitude, "yellow");
			createEntity(latitude, longitude + 0.001, "blue");
			createEntity(latitude, longitude - 0.001, "green");
		}

		function onGeolocationSuccess(position) {
			const { latitude, longitude } = position.coords;
			setLocation(latitude, longitude);
			createEntities(latitude, longitude);
		}

		document.addEventListener("DOMContentLoaded", () => {
			if ("geolocation" in navigator) {
				navigator.geolocation.getCurrentPosition(onGeolocationSuccess, onGeolocationError, {
					enableHighAccuracy: true,
					timeout: 5000,
					maximumAge: 0
				});
			} else {
				console.warn("Geolocation is not available on this device");
			}
		});

	</script>

</head>

<body>

	<a-scene vr-mode-ui='enabled: false' arjs='sourceType: webcam; videoTexture: true; debugUIEnabled: true'
		renderer='antialias: true; alpha: true'>
		<a-camera id="gps-camera" gps-new-camera="gpsMinDistance: 1"></a-camera>
		<!-- Entities will be added dynamically here -->
	</a-scene>


</body>

</html>