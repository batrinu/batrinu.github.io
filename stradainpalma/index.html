<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>AR Example with Three.js and GPS</title>
    <script src="https://cdn.jsdelivr.net/npm/three@0.117.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tween.js@16.9.0/dist/tween.umd.min.js"></script>
  </head>
  <body>
    <script>
      // Initialize Three.js scene
      let scene = new THREE.Scene();
      let camera = new THREE.PerspectiveCamera(
        75,
        window.innerWidth / window.innerHeight,
        0.1,
        1000
      );
      camera.position.z = 5;
      let renderer = new THREE.WebGLRenderer();
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.body.appendChild(renderer.domElement);

      // Create a sphere and add it to the scene
      let geometry = new THREE.SphereGeometry(0.5, 32, 32);
      let material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
      let sphere = new THREE.Mesh(geometry, material);
      scene.add(sphere);

      // Get the current position of the device using the Geolocation API
      navigator.geolocation.getCurrentPosition(function (position) {
        let lat = position.coords.latitude;
        let lng = position.coords.longitude;
        let alt = position.coords.altitude || 0;

        // Convert GPS coordinates to Three.js world coordinates
        let radius = 6371; // Earth's radius in kilometers
        let phi = (90 - lat) * (Math.PI / 180);
        let theta = (360 - lng) * (Math.PI / 180);
        let x = (radius + alt) * Math.cos(phi) * Math.cos(theta);
        let y = (radius + alt) * Math.sin(phi);
        let z = (radius + alt) * Math.cos(phi) * Math.sin(theta);

        sphere.position.set(x, y, z);
      });

      // Create an HTML element to display content for the marker
      let marker = document.createElement("div");
      marker.style.width = "200px";
      marker.style.height = "100px";
      marker.style.backgroundColor = "white";
      marker.style.color = "black";
      marker.innerHTML =
        "This is an example of HTML content displayed for a GPS marker.";
      marker.style.position = "absolute";
      marker.style.top = "50%";
      marker.style.left = "50%";
      marker.style.transform = "translate(-50%, -50%)";
      document.body.appendChild(marker);

      // Set the HTML element's position based on the sphere
      marker.style.left =
        window.innerWidth / 2 + sphere.position.x * 200 + "px";
      marker.style.top =
        window.innerHeight / 2 + sphere.position.y * 200 + "px";
      let animate = function () {
        requestAnimationFrame(animate);

        renderer.render(scene, camera);
      };

      animate();
    </script>
  </body>
</html>
